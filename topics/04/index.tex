% arara: pdflatex: { shell: true, interaction: nonstopmode }
% arara: biber
% arara: pdflatex: { shell: true }

\documentclass[numbers=endperiod, DIV=15, bibliography=totocnumbered]{scrartcl}

% Base packages
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[bulgarian]{babel}
\usepackage[pdfencoding=unicode]{hyperref}
\usepackage{biblatex}
\usepackage[style=german]{csquotes}

% Base math packages
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}

% Misc packages
\usepackage{tikz}
\usepackage{float} % Allowing figures inside minipages
\usepackage{ulem} % Line-breaking underlines

% Custom packages
\usepackage{../../common/macros}
\usepackage{../../common/theorems}

% Bibliography
\addbibresource{./references.bib}

% Document
\title{[WIP] Тема 4}
\subtitle{Граница, непрекъснатост, производна и примитивна на функция на една променлива. Геометрична интерпретация.}
\author{Янис Василев, \Email{ianis@ivasilev.net}}
\date{5 юли 2019}

\begin{document}

\maketitle

\section{Теория}

Теорията е разписана без външни източници.

\subsection{Анотация}

Изложената анотацията е взета от конспекта~\cite{Syllabus} за 2018г.

\begin{enumerate}
  \item Дефиниции на Хайне и Коши за граница на функция в крайна точна и в безкрайността
  \item Еквивалентност на дефинициите на Хайне и Коши за
  \item Дефиниция за непрекъснатост на функция чрез дефинициите на Хайне и Коши
  \item Дефиниция за производна на функция като граница на диференчните частно
  \item Физична интерпретация на производната като моментна скорост
  \item Геометрична интерпретация на производната в точка като ъглов коефициент на допирателната към графиката на функцията
  \item Формули за сума, произведение, частно и съставна функция на две диференцируеми функции
  \item Производни на степенна, показателна и основните тригонометрични функции
  \item Формула за производна на обратна функция
  \item Дефиниция за примитивна функция
  \item Разликата на две примитивни функции е константа
\end{enumerate}

\subsection{Граница на редица}

Ще бележим редиците с ${\{ a_k \}}_{k=1}^\infty$ или просто с $\{ a_k \}$, когато няма опасност от недоразумение. Ще предполагаме, че всички редици са безкрайни.

\begin{definition}
  Нека $D \subseteq \R$ е произволно непразно множество. Казваме, че $a \in D$ е \uline{точка на сгъстяване на множеството $D$} или \uline{гранична точка на $D$}, ако във всяка околност на $a$ има точки на $D$, различни от $a$.
\end{definition}

\begin{definition}
  Нека $D \subseteq \R$ и $\{ a_k \} \subseteq D$ е произволна редица. Казваме, че $a$ е \uline{граница на редицата $\{ a_k \}$} или че \uline{редицата $\{ a_k \}$ клони към $a$}, ако всяка околност на $a$ съдържа цялата редица с изключение на краен брой членове. Пишем
  \begin{align*}
    \lim_{k \to \infty} a_k = a,
    &&
    a_k \underset {k \to \infty} \longrightarrow a.
  \end{align*}

  Ако една редица има граница, казваме, че \uline{редицата е сходяща}. Ако една редица не е сходяща, тя е \uline{разходяща}.
\end{definition}
\begin{note}
  В общия случай е възможно $a \not\in D$.
\end{note}

\begin{proposition}
  Сходящите редици $\{ a_k \} \subseteq D$ имат единствена граница.
\end{proposition}
\begin{proof}
  Нека $a$ и $b$ са граници на редицата $\{ a_k \}$. Ако $a$ и $b$ са различни, те непременно имат поне една двойка непресичащи се околности (това е Хаусдорфовото свойство на реалните числа).

  От друга страна, ако $U_a$ и $U_b$ са някакви околности на $a$ и $b$, те непременно се пресичат, тъй като и двете съдържат цялата редица с изключение на краен брой членове. Заключаваме, че $a = b$.
\end{proof}

\begin{note}
  Определенията за точки на сгъстяване и за граница на редица се пренасят без изменение за произволни топологични пространства. Сходимостта, обаче, не е непременно еднозначна, ако пространството не е Хаусдорфово.

  Следващите определение вече са специфични за реалните числа.
\end{note}

\begin{definition}
  Нека редицата $\{ a_k \}$ е неограничена, т.е. всяка околност на $0$ съдържа само краен брой нейни елементи. Казваме, че редицата \uline{клони към безкрайност} и пишем
  \begin{displaymath}
    \lim_{k \to \infty} a_k = \infty,
  \end{displaymath}
  ако редицата е (нестрого) монотонно растяща с изключение на краен брой членове.

  Аналогично се дефинира \uline{сходимост към отрицателна безкрайност} ($-\infty$) за неограничени монотонно намаляващи редици.
\end{definition}

\subsection{Граница на функция}

\begin{note}
  За съжаление, когато допуснем сходимост във и към безкрайни точки, можем да получим комбинаторна експлозия от определения. Затова в началото ще дадем различни дефиниции само за сходимост във и към крайни точки и ще докажем еквивалентността им, а след това ще дадем само едно определение за останалите видове сходимост.

  Алтернативен подход е да се използва компактификация, т.е. добавяне на точките $\infty$ и $-\infty$ като класове на еквивалентност редици, клонящи към безкрайност. Този подход, обаче, конфликтира с алгебричните свойства на реалните числа и е прекалено нестандартен, за да се използва на изпит.
\end{note}

\begin{definition}[Сходимост по Хайне]
  Нека $a$ е точка на сгъстяване на $D \subseteq \R$. Казваме, че \uline{функцията $f: D \to \R$ клони към $A$ при $x$ клонящо към $a$} или \uline{$A$ е граница на $f(x)$ при $x$ клонящо към $a$} и пишем
  \begin{align*}
    \lim_{x \to a} f(x) = A,
    &&
    f(x) \underset {x \to a} \longrightarrow A,
  \end{align*}
  ако за всяка сходяща към $a$ редица $\{ a_k \} \subseteq D$ съответната редица от функционални стойности ${\{ f(a_k) \}}_{k=1}^\infty$ клони към $A$.
\end{definition}

\begin{definition}[Сходимост по Коши]
  Нека $a$ е точка на сгъстяване на $D \subseteq \R$. Казваме, че \uline{функцията $f: D \to \R$ клони към $A$ при $x$ клонящо към $a$}, ако за всяко положително число $\varepsilon > 0$ съществува $\delta > 0$, така че за всяко $x \in \R$ при $\Abs{x - a} < \delta$ да е изпълнено $\Abs{f(x) - A} < \varepsilon$.
\end{definition}

\begin{note}
  В общия случай, функцията може не просто да не съвпада с границата си в дадена точка, а може и да не бъде дефиниране в тази точка.
\end{note}

\begin{theorem}\label{thm:heine-iff-cauchy}
  Определенията на Хайне и Коши за сходимост са еквивалентни.
\end{theorem}
\begin{proof}
  (Хайне $\implies$ Коши). Нека $f: D \to \R$ клони към $A$ в точката $a$ според определението на Хайне и нека $\varepsilon > 0$ е произволно. Нека редицата $\{ a_k \} \subseteq D$ да клони към $a$.

  Разглеждаме $\varepsilon$-околността $(A - \varepsilon, A + \varepsilon)$ на $A$. Според определенията за сходимост по Хайне и сходимост на редица, тази околност съдържа безброй елементи на редицата $\{ f(a_k) \}$.

  Нека $n$ е най-големият индекс, за който $\Abs{f(a_n) - A} \geq \varepsilon$, или $n = 0$, ако няма такъв индекс. Подредицата ${\{ a_k \}}_{k > n}$ на ${\{ a_k \}}_{k > 0}$ клони към същата граница $a$ като цялата редица. Тогава съществува някаква околност на $a$, съдържаща изцяло подредицата ${\{ a_k \}}_{k > n}$. Нека интервалът $(a - \delta, a + \delta)$ се съдържа в тази околност.

  Тогава за произволен елемент $b \in (a - \delta, a + \delta)$ имаме $\Abs{f(b) - A} < \varepsilon$ и следователно е изпълнено определението на Коши за сходимост.

  (Коши $\implies$ Хайне). Нека $f: D \to \R$ клони към $A$ в точката $a$ според определението на Коши.

  Нека $U$ е произволна околност на $A$ и нека числото $\varepsilon > 0$ е такова, че интервалът $(A - \varepsilon, A + \varepsilon)$, който също е околност на $A$, се съдържа в $U$. От определението на Коши за сходимост съществува число $\delta > 0$, за което за произволно $x \in \R$ неравенството $\Abs{x - a} < \delta$ да влече $\Abs{f(x) - A} < \varepsilon$.

  Нека редицата $\{ a_k \}$ клони към $a$ и нека $n$ е най-големият индекс, за който $\Abs{a - a_n} \geq \delta$, или $n = 0$, ако няма такива членове. Тогава подредицата ${\{ a_k \}}_{k>n}$ също клони към $a$, а редицата ${\{ f(a_k) \}}_{k>n}$ се съдържа изцяло в околността $(A - \varepsilon, A + \varepsilon) \subseteq U$ на $a$.

  Но това означава, че редицата ${\{ f(a_k) \}}_{k>0}$ клони към $A$ и следователно е изпълнено определението на Хайне за сходимост.
\end{proof}

\begin{definition}[Едностранна сходимост по Хайне]
  Нека $a$ е точка на сгъстяване на $D \subseteq \R$. Казваме, че \uline{$A$ е лява граница на $f: D \to \R$ при $x$ клонящо към $a$} и пишем
  \begin{align*}
    \lim_{x \uparrow a} f(x) = A,
    &&
    f(x) \underset {k \uparrow a} \longrightarrow A,
  \end{align*}
  ако за всяка сходяща към $a$ монотонно растяща (с изключение на краен брой членове) редица $\{ a_k \} \subseteq D$ съответната редица от функционални стойности ${\{ f(a_k) \}}_{k=1}^\infty$ клони към $A$.

  Аналогично определяме \uline{дясна граница на $f(x)$ при $x$ клонящо към $a$} за монотонно намаляващи редици с означението $f(x) \underset {k \downarrow a} \longrightarrow A$.
\end{definition}

\begin{definition}[Обобщена сходимост по Хайне]
  Нека редицата $\{ a_k \} \subseteq D$ клони към крайна или безкрайна граница $a$, т.е. $a$ е точка на сгъстяване на $D$ или $a = \pm \infty$, а редицата от функционални стойности $\{ f(a_k) \}$ клони към крайна или безкрайна граница $A$, т.е. $A \in \R$ или $A = \pm \infty$. Казваме, че \uline{функцията $f(x)$ клони към $A$ при $x$ клонящо към $a$} и пишем
  \begin{displaymath}
    \lim_{x \to a} f(x) = A.
  \end{displaymath}
\end{definition}

\subsection{Непрекъснатост}

\begin{definition}[Непрекъснатост по Хайне]
  Нека $D \subseteq \R$ и $a \in D$ е точка на сгъстяване на $D$. Казваме, че \uline{функцията $f: D \to \infty$ е непрекъсната в точката $a$}, ако за произволна редица $\{ a_k \} \subseteq D$, клоняща към $a$, съответната редица $\{ f(a_k) \}$ от функционални стойности клони към $f(a)$.

  Ако сходимостта е лява, т.е. $f(x) \underset {k \uparrow a} \longrightarrow f(a)$, казваме, че \uline{$f(x)$ е непрекъсната отляво в $a$}. Аналогично се определя непрекъснатост отдясно.
\end{definition}

\begin{definition}[Непрекъснатост по Коши]
  Нека $D \subseteq \R$ и $a \in D$ е точка на сгъстяване на $D$. Казваме, че \uline{функцията $f: D \to \infty$ е непрекъсната в точката $a$}, ако за всяко положително число $\varepsilon > 0$ съществува $\delta > 0$, така че за всяко $x \in \R$ при $\Abs{x - a} < \delta$ да е изпълнено $\Abs{f(x) - f(a)} < \varepsilon$.
\end{definition}

\begin{note}
  От теорема~\ref{thm:heine-iff-cauchy} следва, че двете определения за непрекъснатост съвпадат.
\end{note}

\begin{definition}
  Казваме, че една \uline{функцията $f(x)$ е непрекъсната} или \uline{поточково непрекъсната}, ако $f(x)$ е непрекъсната във всяка точка от дефиниционната си област.
\end{definition}

\subsection{Диференцируемост}

\begin{definition}
  Нека точката $a$ принадлежи на $D$ заедно със своя дясна околност, т.е. за някое число $\varepsilon > 0$ интервалът $[a, a + \varepsilon)$ лежи изцяло в $D$. \uline{Дясна производна на функцията $f: D \to \R$ в точка $a \in D$} наричаме границата
  \begin{displaymath}
    \lim_{h \downarrow 0} \frac {f(a + h) - f(a)} h.
  \end{displaymath}

  Ако $f(x)$ има дясна производна в точка $a$, казваме, че тя е \uline{диференцируема отдясно} в тази точка.
  Частното $\frac {f(a + h) - f(a)} h$ наричаме диференчно частно.

  Аналогично се дефинира \uline{лява производна} и \uline{диференцируемост отляво}.

  Ако лявата и дясната производна на $f(a)$ съществуват едновременно и те съвпадат, тяхната обща стойност се нарича \uline{производна на $f(x)$ в точка $a$} и се означава с $f'(a)$, а за функцията $f(x)$ казваме, че е \uline{диференцируема в $a$}.

  Ако $D \subseteq \R$ е отворено множество и функцията $f: D \to \R$ е диференцируема в цялата си дефиниционна област, казваме, че тя е \uline{диференцируема}. В такъв случай производните се разглеждат като функция на $x \in D$.

  Ако функцията $f(x)$ е диференцируема в $a$, \uline{диференциал $df(a)$ на $f(x)$ в точката $a$} наричаме линейната функция $h \mapsto f'(a) \cdot h$.

  Диференциалът на променливата $x$, разгледана като идентитет, е също идентитет, тъй като диференчното частно $\frac {(x + h) - x} h$ на идентитета е константата $1$. Понеже диференциалът $dx(a)$ не зависи от точката $a$, ще пишем просто $dx$.

  Това ни дава основание да въведем \uline{означенията на Лайбниц за производни} като частно на диференциалите
  \begin{displaymath}
    \frac {df(a)} {dx} = \frac {f'(a) \cdot h} h = f'(a).
  \end{displaymath}
\end{definition}

\begin{note}
  Ако множеството $D$ не е отворено, за функцията $f(x)$ с дефиниционна област $D$ не възможно да се определят леви или десни производни в някои точки. Затова обикновено, когато говорим за диференцируемост, искаме функцията да бъде дефинирана в отворено множество.
\end{note}

\begin{theorem}[Механична интерпретация на производна]
  Нека $T > 0$ и функцията $f: [0, T] \to \R$ е диференцируема в точка $t \in (0, T)$. Ако пътят, изминат от материална частица за време $x$, се описва чрез функцията $f(x)$, тогава моментната скорост във времето $t$ е равна на $f'(t)$.
\end{theorem}
\begin{proof}
  Изразявайки приблизително нарастването на пътя $f(t+h) - f(t) \approx h v(t)$ като нарастването на времето $t$ умножено по скоростта $v(t)$ на движение в момента $t$, получаваме
  \begin{displaymath}
    v(t) = \frac{f(t+h) - f(t)} {h} \underset {h \to 0} \longrightarrow f'(t).
  \end{displaymath}
\end{proof}

\bigskip
\begin{minipage}{0.5\textwidth}
  \begin{theorem}[Геометрична интерпретация на производна]
    Нека $D \subseteq \R$ и функцията $f: D \to \R$ е диференцируема в точка $a \in D$. Разглеждаме графиката $\Gamma_f = \{ (x, f(x)) \mid x \in D \}$ на $f(x)$ като параметрична крива в равнината.

    За някое достатъчно малко число $h \in \R$ разглеждаме секущата $d_h$ през точките с координати $(a, f(a))$ и $(a+h, f(a+h))$ (фиг.~\ref{fig:secant}). Декартовите уравнения на тези секущи при $h \to 0$ клонят към декартово уравнение на допирателна права $d$ към $\Gamma_f$ в точката $a$.

    Твърдим, че декартовото уравнение на тази допирателна права е
    \begin{displaymath}
      d: y = f'(a) (x-a) + f(a).
    \end{displaymath}
  \end{theorem}
\end{minipage}
\hspace{1cm}
\begin{minipage}{0.45\textwidth}
  \begin{figure}[H]
    \begin{center}
      \begin{tikzpicture}
        \draw[->] (-1,0) -- (4,0) node[below right] {$x$};
        \draw[->] (0,-1) -- (0,4) node[left] {$y$};
        \draw [domain=-1:2.7, samples=40] plot (\x, \x^2/2);
        \filldraw [black] (2, 2) circle (1.5pt);
        \filldraw [black] (1/2, 1/8) circle (1.5pt);
        \draw[-] (0, -1/2) -- (16/5, 3.5);
      \end{tikzpicture}
    \end{center}
    \caption{Секуща през две точки от графиката}\label{fig:secant}
  \end{figure}
\end{minipage}
\begin{proof}
  Тъй като точките $(a, f(a))$ и $(a+h, f(a+h))$ лежат върху правата $d_h$, получаваме общото уравнение за $d_h$
    \begin{displaymath}
      d_h: \det \begin{pmatrix}
      (a+h)-x & (a+h)-a \\
      f(a+h)-y & f(a+h)-f(a)
    \end{pmatrix}
    = 0.
  \end{displaymath}

  Оттук намираме декартовото уравнение на $d_h$:
  \begin{align*}
    d_h&: (f(a+h) - f(a)) (a+h-x) - (f(a+h)-y)h \mid \cdot \frac 1 h = 0,
    \\
    d_h&: \frac {f(a+h) - f(a)} h (a-x) + (f(a+h) - f(a)) - f(a+h) + y = 0,
    \\
    d_h&: y = -\frac {f(a+h) - f(a)} h (a-x) + f(a),
    \\
    d_h&: y = \frac {f(a+h) - f(a)} h (x-a) + f(a).
  \end{align*}

  С граничен предох при $h \to 0$ получаваме уравнението от твърдението на теоремата.
\end{proof}

\printbibliography

\end{document}
